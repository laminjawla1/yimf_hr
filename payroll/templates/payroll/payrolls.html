{% extends "staff/layout.html" %}
{% load humanize %}
{% block content %}
<style>
  /* body {
    padding-right: 30%;
  } */
    /* Tablet */
    @media (min-width:600px) {
      body {
          padding-right: 30%;
        } 
    }

    /* Desktop */
    @media (min-width:900px) {
        body {
          padding-right: 30%;
        } 
      }
</style>
<form action="{% url 'staff_payslip' %}" method="post" class="d-flex" role="search">
  {% csrf_token %}
  <input list="employees" name="employee" id="employee" class="form-control me-2" type="search" placeholder="Staff Name" aria-label="Search">
  <input name="staff_id" id="staff_id" class="form-control me-2" type="search" placeholder="Staff ID" aria-label="Search">
  <datalist id="employees">
    {% for employee in employees %}
    <option value="{{ employee.employee_name }}">
    {% endfor %}
</datalist>
  <input class="form-control me-2" type="date" name="date">
  <button class="btn btn-success" type="submit">Generate</button>
</form>
<small><a class="btn btn-primary" href="{% url 'add_payroll' %}">Add Payroll</a></small>
<table class="table table-striped table-bordered table-dark table-striped-columns table-responsive-xl">
    <thead class="thead-dark">
    <tr>
      <th scope="col">Employee_Name</th>
      <th scope="col">Basic</th>
      <th scope="col">Medical</th>
      <th scope="col">Transport</th>
      <th scope="col">Responsibility</th>
      <th scope="col">Housing</th>
      <th scope="col">Gross</th>
      <th scope="col">Income_Tax</th>
      <th scope="col">SSHFC</th>
      <th scope="col">IND_SSHFC</th>
      <th scope="col">Deduction</th>
      <th scope="col">Staff_Fin</th>
      <th scope="col">ICF</th>
      <th scope="col">NET</th>
      <th scope="col">Emp_Payroll_Date</th>
    </tr>
  </thead>
  <tbody>
    {% for payroll in payrolls %}
    <tr>
        <td><a type="payroll" href="{% url 'render_payslip' payroll.id %}">{{payroll.employee}}</a></td>
        <td>{{payroll.basic_salary|floatformat:2|intcomma}}</td>
        <td>{{payroll.medical_allowance|floatformat:2|intcomma}}</td>
        <td>{{payroll.transport_allowance|floatformat:2|intcomma}}</td>
        <td>{{payroll.responsibility_allowance|floatformat:2|intcomma}}</td>
        <td>{{payroll.housing_allowance|floatformat:2|intcomma}}</td>
        <td>{{payroll.gross_pay|floatformat:2|intcomma}}</td>
        <td>{{payroll.income_tax|floatformat:2|intcomma}}</td>
        <td>{{payroll.sshfc|floatformat:2|intcomma}}</td>
        <td>{{payroll.individual_sshfc|floatformat:2|intcomma}}</td>
        <td>{{payroll.deduction|floatformat:2|intcomma}}</td>
        <td>{{payroll.staff_fin|floatformat:2|intcomma}}</td>
        <td>{{payroll.icf|floatformat:2|intcomma}}</td>
        <td>{{payroll.net_pay|floatformat:2|intcomma}}</td>
        <td>{{payroll.date|date:"F d, Y" }}</td>
        <td><a href="{% url 'update_payroll' payroll.id %}">Edit</a></td>
    </tr>
    {% endfor %}
    <tr>
        <td scope="col" style="font-weight: bold; color: red;">TOTALS</td>
        <td scope="col" style="font-weight: bold;">{{ basic_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ medical_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ transport_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ responsibility_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ housing_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ gross_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ income_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ sshfc_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ individual_sshfc_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ deduction_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ staff_fin_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ icf_total|floatformat:2|intcomma }}</td>
        <td scope="col" style="font-weight: bold;">{{ net_total|floatformat:2|intcomma }}</td>
    </tr>
    <tr>
        <td scope="col" colspan="1" style="font-weight: bold; color: red;">ABS TOTAL</td>
        <td scope="col" colspan="12" style="font-weight: bold;text-align: center;">{{ absolute_total|floatformat:2|intcomma }}</td>
</tbody>
</table>
{% if payrolls.has_previous %}
<a class="btn btn-outline-info mb-4" href="{% url 'payrolls' %}?page=1">First</a>
<a class="btn btn-outline-info mb-4" href="{% url 'payrolls' %}?page={{ payrolls.previous_page_number }}">Previous</a>
{% endif %}

{% for num in payrolls.paginator.page_range %}
{% if payrolls.number == num %}
  <a class="btn btn-info mb-4" href="{% url 'payrolls' %}?page={{ num }}">{{ num }}</a>
{% elif num > payrolls.number|add:'-3' and num < payrolls.number|add:'3' %}
  <a class="btn btn-outline-info mb-4" href="{% url 'payrolls' %}?page={{ num }}">{{ num }}</a>
{% endif %}
{% endfor %}

{% if payrolls.has_next %}
<a class="btn btn-outline-info mb-4" href="{% url 'payrolls' %}?page={{ payrolls.next_page_number }}">Next</a>
<a class="btn btn-outline-info mb-4" href="{% url 'payrolls' %}?page={{ payrolls.paginator.num_pages }}">Last</a>
{% endif %}
{% endblock content %}